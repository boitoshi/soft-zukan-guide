name: ğŸ® Pokemon Zukan Master Deploy

on:
  push:
    branches: [ main ]

permissions:
  contents: read
  pages: write
  id-token: write

jobs:
  build-and-deploy:
    environment:
      name: github-pages
      url: ${{ steps.deployment.outputs.page_url }}
    runs-on: ubuntu-latest
    
    steps:
      - name: ğŸ“¦ Checkout
        uses: actions/checkout@v4
        
      - name: ğŸš€ Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '18'
          
      - name: ğŸ”§ Build deploy files
        run: |
          echo "ğŸ® ãƒã‚±ãƒ¢ãƒ³å›³é‘‘ãƒã‚¹ã‚¿ãƒ¼ã®ãƒ“ãƒ«ãƒ‰ã‚’é–‹å§‹..."
          node build-deploy.js
          echo "âœ¨ ãƒ“ãƒ«ãƒ‰å®Œäº†ï¼"
          
      - name: ğŸ“Š Convert CSV data
        run: |
          echo "ğŸ“Š ãƒã‚±ãƒ¢ãƒ³ãƒ‡ãƒ¼ã‚¿ã‚’å¤‰æ›ä¸­..."
          if [ -f "universal-csv-converter.js" ]; then
            node universal-csv-converter.js --all || echo "âš ï¸ CSVå¤‰æ›ã‚’ã‚¹ã‚­ãƒƒãƒ—ï¼ˆãƒ‡ãƒ¼ã‚¿ãŒæœ€æ–°ã§ã™ï¼‰"
          fi
          echo "âœ… ãƒ‡ãƒ¼ã‚¿å‡¦ç†å®Œäº†ï¼"
        
      - name: ğŸŒ Setup Pages
        uses: actions/configure-pages@v4
        
      - name: ğŸ“¤ Upload artifact
        uses: actions/upload-pages-artifact@v3
        with:
          path: './deploy'
          
      - name: ğŸš€ Deploy to GitHub Pages
        id: deployment
        uses: actions/deploy-pages@v4
